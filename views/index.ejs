<!DOCTYPE html>
<html>

<head>
  <title>Chat Application</title>
  <style>
   body{
    background-image: linear-gradient(rgb(250, 249, 249),rgb(94, 168, 152));
    height: 100vh;
}

h1 {
    display: block;
    margin: auto;
    width: 500px;
    text-align: center;
}

.container {
    max-width: 700px;
    border: 2px solid rgb(182, 32, 32);
    background-color: azure;
    border-radius: 13px;
    padding: 33px;
    margin-bottom: 30px !important;
    overflow-y: auto;
    margin: auto;
    height: 60vh;
}

.message {
    background-color: rgb(113, 204, 169);
    max-width: 100px;
    padding: 10px;
    margin: 10px 2px;
    border: 2px solid #5a4343;
    border-radius: 5px;
}

.left {
    float: left;
    clear: both;
    background-color: rgb(144, 148, 146);
    max-width: 1000px;
    padding: 5px;
    margin: 10px 20px;
    border: 2px solid #5a4343;
    border-radius: 5px;
}

.right {
    float: right;
    clear: both;
}

#send-container {
    display: block;
    margin: auto;
    text-align: center;
    max-width: 1031px;
    width: 100%;
}

#messageInp{
    width : 69%;
    border: 2px solid black;
    border-radius: 6px;
    height: 34px;
}

.btn {
  width: 5%;
    cursor: pointer;
    border: 2px solid black;
    border-radius: 6px ;
    height: 40px;
}
  </style>
</head>

<body>
  <h1>Chat Application</h1>

  <div class="container"></div>

  <div class="send">
      <form action="#" id="send-container">
          <input type="text" name="messageInp" id="messageInp">
          <button class="btn" type="submit">send</button>
      </form>
  </div>
<script  src="/socket.io/socket.io.js"></script>
  <script >
    const socket = io();

    
const form = document.getElementById('send-container');
const messageInp = document.getElementById('messageInp');
const messageContainer = document.querySelector(".container");

const append = (message , position) => {
    const messageElement = document.createElement('div');
    messageElement.innerText = message;
    messageElement.classList.add('message');
    messageElement.classList.add(position);
    messageContainer.append(messageElement);
    if (position === 'left'){
    }
}

    form.addEventListener('submit' ,(e) => {
        e.preventDefault();
        const message = messageInp.value;
        append(`You: ${message}`,'right');
        socket.emit('send',message);
        messageInp.value = '';
    })

let name = prompt("Enter your name to join");
socket.emit('new-user-joined', name);

socket.on('user-joined', name => {
    append(`${name} joined the chat`,'left');
})

socket.on ('receive',(data) => {
    append(`${data.name} : ${data.message}`,'left');
})

socket.on('left',name => {
    append(`${name} left the chat`,'middle');
})

  </script>
</body>
</html>
